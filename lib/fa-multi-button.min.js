"use strict";!function(t){t.fn.famultibutton=function(o){function e(){m=!0,h.bg.css("color",P.onBackgroundColor),h.fg.css("color",P.onColor),u.addClass("active"),h.trigger("setOn")}function n(){m=!1,h.bg.css("color",P.offBackgroundColor),h.fg.css("color",P.offColor),u.removeClass("active"),h.trigger("setOff")}function i(){t("<div />").animate({width:100},{duration:700,easing:"swing",step:function(t,o){var e=(t-o.start)/(o.end-o.start);h.bg.css("color",s(P.onBackgroundColor,P.offBackgroundColor,e)),h.fg.css("color",s(P.onColor,P.offColor,e))},complete:function(){!0===m&&e()}})}function a(t){var o=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return o&&4===o.length?"#"+("0"+parseInt(o[1],10).toString(16)).slice(-2)+("0"+parseInt(o[2],10).toString(16)).slice(-2)+("0"+parseInt(o[3],10).toString(16)).slice(-2):t}function s(t,o,e){t=a(t).replace(/^\s*#|\s*$/g,""),o=a(o).replace(/^\s*#|\s*$/g,""),3==t.length&&(t=t.replace(/(.)/g,"$1$1")),3==o.length&&(o=o.replace(/(.)/g,"$1$1"));var n=parseInt(t.substr(0,2),16),i=parseInt(t.substr(2,2),16),s=parseInt(t.substr(4,2),16),r=parseInt(o.substr(0,2),16)-n,l=parseInt(o.substr(2,2),16)-i,f=parseInt(o.substr(4,2),16)-s;return r=(r*e+n).toString(16).split(".")[0],l=(l*e+i).toString(16).split(".")[0],f=(f*e+s).toString(16).split(".")[0],1==r.length&&(r="0"+r),1==l.length&&(l="0"+l),1==f.length&&(f="0"+f),"#"+r+l+f}function r(){clearTimeout(d),(w=k>0?w-=P.step:w+=P.step)>P.max&&(w=P.max),w<P.min&&(w=P.min),l();var t=C[Math.abs(k)];d=setTimeout(function(){r()},500-t)}function l(){var t=g[0];if(t.height=h.h,t.width=h.w,t.getContext){var o=t.getContext("2d");o.strokeStyle=P.offBackgroundColor;for(var e=P.max,n=P.min,i=t.height-Math.round(t.height*(w-n)/(e-n)),a=0;a<t.height;a+=4)o.lineWidth=1,o.beginPath(),o.moveTo(5,a),o.lineTo(25,a),o.stroke();o.strokeStyle=m?P.onBackgroundColor:s(P.offBackgroundColor,"#ffffff",.4),o.lineWidth=3,o.beginPath(),o.moveTo(5,i),o.lineTo(25,i),o.stroke(),o.fillStyle=s(P.offBackgroundColor,"#ffffff",.4),o.font="10px sans-serif",o.fillText(w,30,t.height)}}function f(){g.css({position:"absolute","z-index":-1}),x?g.animate({left:.6*-h.w+"px"}):g.animate({left:h.w/5+"px",top:"0px"})}function c(){var o,a,s,c=function(t){var o=(t=(t||navigator.userAgent).toLowerCase()).match(/android\s([0-9\.]*)/);return!!o&&o[1]}(),C=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,I=c&&parseFloat(c)<5||C,y=I?"touchstart":"touchstart mousedown",S=I?"touchmove":"touchmove mousemove",B=I?"touchend":"touchend mouseup",D=I?"touchleave":"touchleave mouseout";"push"===P.mode?(u.on(y,function(e){e.stopImmediatePropagation(),a=t(window).scrollTop(),o=t(window).scrollLeft()}),u.on(B,function(n){if(n.preventDefault(),n.stopImmediatePropagation(),!(Math.abs(a-t(window).scrollTop())>3||Math.abs(o-t(window).scrollLeft())>3))return s=m,e(),"function"==typeof P.toggleOn&&P.toggleOn.call(this),m=!1,setTimeout(function(){i()},200),!0===s&&setTimeout(function(){e()},1e3),h.trigger("clicked"),!1})):"updown"==P.mode?(u.on(y,function(t){t.preventDefault(),t.stopImmediatePropagation(),s=m,e(),"function"==typeof P.toggleOn&&P.toggleOn.call(this)}),u.on(B,function(t){return t.preventDefault(),t.stopImmediatePropagation(),"function"==typeof P.toggleOff&&P.toggleOff.call(this),m=!1,setTimeout(function(){i()},200),!0===s&&setTimeout(function(){e()},1e3),h.trigger("clicked"),!1})):"toggle"==P.mode?(u.on(y,function(e){e.stopImmediatePropagation(),a=t(window).scrollTop(),o=t(window).scrollLeft()}),u.on(B,function(i){if(i.preventDefault(),i.stopImmediatePropagation(),!(Math.abs(a-t(window).scrollTop())>3||Math.abs(o-t(window).scrollLeft())>3))return m?(n(),"function"==typeof P.toggleOff&&P.toggleOff.call(this),P.timeout>0&&(p=setTimeout(function(){e()},P.timeout))):(e(),"function"==typeof P.toggleOn&&P.toggleOn.call(this),P.timeout>0&&(p=setTimeout(function(){n()},P.timeout))),h.trigger("clicked"),!1})):"dimmer"==P.mode&&(u.on(y,function(t){t.preventDefault(),t.stopImmediatePropagation();var o=t.originalEvent;b=o.touches?o.touches[0].clientY:t.pageY,k=0,O=!0}),u.on(D,function(t){t.preventDefault(),t.stopImmediatePropagation(),x&&(x=!1,u.animate({top:0}),clearInterval(d),v=!1,f()),O=!1}),u.on(B,function(t){return t.preventDefault(),t.stopImmediatePropagation(),x?(x=!1,u.animate({top:0}),clearTimeout(d),v=!1,"function"==typeof P.valueChanged&&P.valueChanged.call(this,w)):m?(n(),"function"==typeof P.toggleOff&&P.toggleOff.call(this),P.timeout>0&&(p=setTimeout(function(){e()},P.timeout))):(e(),"function"==typeof P.toggleOn&&P.toggleOn.call(this),P.timeout>0&&(p=setTimeout(function(){n()},P.timeout))),x=!1,O=!1,f(),l(),h.trigger("clicked"),!1}),u.on(S,function(t){t.preventDefault(),t.stopImmediatePropagation(),O&&(x=!0);var o=t.originalEvent;if(T=o.touches?o.touches[0].clientY:t.pageY,(k=T-b)>20&&(k=20),k<-20&&(k=-20),x){this.style.top=k+"px";g[0].style.top=-k+"px",v||(f(),r(),v=!0)}}))}if(this.length>1)return this.each(function(){t(this).famultibutton(o)}),this;var u,g,d,p,h=this,m=!1,v=!1,C=[0,10,40,80,120,140,150,160,180,200,240,260,280,300,320,420,430,440,450,460,470],b=0,w=0,k=0,I=0,T=0,x=!1,O=!1,P=t.extend({},{backgroundIcon:"fa-circle",classes:["fa-2x"],icon:"fa-power-off",offColor:"#2A2A2A",offBackgroundColor:"#505050",onColor:"#2A2A2A",onBackgroundColor:"#aa6900",mode:"toggle",toggleOn:null,toggleOff:null,valueChanged:null,progressWidth:15,timeout:0,max:100,min:0,step:1},o);return this.setOn=function(){clearTimeout(p),e()},this.setOff=function(){clearTimeout(p),n()},this.getState=function(){return m},this.getValue=function(){return w},this.setDimValue=function(t){w=t,l()},this.setProgressValue=function(o){!function(o){var e=h.find("canvas#progress");if(o>0){0===e.length&&(e=t("<canvas>").attr({id:"progress"}).appendTo(u));var n=e[0];if(n){n.height=h.h,n.width=h.w;var i=n.width/2,a=n.height/2;if(n.getContext){var s=n.getContext("2d");s.beginPath(),s.strokeStyle=P.onColor,s.arc(i,a,i*(-.4/90*Number(P.progressWidth)+.8),-.5*Math.PI,(2*o-.5)*Math.PI,!1),s.lineWidth=.8*i*P.progressWidth/100,s.stroke()}}}else h.find("canvas#progress").remove()}(o)},this.setForegroundColor=function(t){!function(t){h.fg.css("color",t)}(t)},this.setBackgroundColor=function(t){!function(t){h.bg.css("color",t)}(t)},this.setForegroundIcon=function(t){!function(t){h.fg.removeClass(h.fi),h.fi=t,h.fg.addClass(h.fi)}(t)},this.setBackgroundIcon=function(t){!function(t){h.bg.removeClass(h.bi),h.bi=t,h.bg.addClass(h.bi)}(t)},function(){P=t.extend({},P,h.data());var o=h.html()!==h.text()?h.children().detach():jQuery("<div>",{}).text(h.text());if("none"!==P.onColor&&"none"!==P.offColor&&o.attr("id","fg"),o.addClass("fa-stack-1x"),h.html(""),h.bi=P.backgroundIcon,h.fi=P.icon,(u=t("<div/>",{class:"famultibutton"})).addClass("fa-stack"),h.bg=jQuery("<i/>",{id:"bg",class:"fa fa-stack-2x"}).addClass(h.bi),h.fg=jQuery("<i/>",{id:"fg",class:"fa fa-stack-1x"}).addClass(h.fi),P.classes&&P.classes.length>0)for(var e=0,i=P.classes.length;e<i;e++)u.addClass(P.classes[e]);return h.bg.appendTo(u),h.fg.appendTo(u),o.appendTo(u),u.appendTo(h),h.o=P,h.w=u.width(),h.h=u.height(),n(),"dimmer"==P.mode&&(g=t("<canvas>").attr({id:"scale",height:h.h+"px",width:h.w+"px"}).appendTo(u),I=parseInt(g.offset().top)-parseInt(u.offset().top),l(),f()),h.data("famultibutton",h),c(),h}()}}(jQuery);